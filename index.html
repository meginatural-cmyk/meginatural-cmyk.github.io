<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nefetc Sosyal</title>
    <style>
        .post-link {
            display: inline-block;
            margin-top: 10px;
            color: #0095f6;
            text-decoration: none;
            font-weight: bold;
            font-size: 14px;
        }
        .auth-box {
            max-width: 350px;
            margin: 100px auto;
            background: white;
            padding: 30px;
            border: 1px solid #dbdbdb;
            text-align: center;
        }
        .auth-box input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #dbdbdb;
            background: #fafafa;
        }
        
        :root { --nefetc-blue: #0095f6; --bg: #fafafa; --border: #dbdbdb; }
        body { font-family: -apple-system, sans-serif; background-color: var(--bg); margin: 0; }
        
        /* GiriÅŸ EkranÄ± */
        .auth-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .auth-box { background: white; border: 1px solid var(--border); padding: 40px; width: 350px; text-align: center; }
        .logo { font-size: 32px; font-weight: bold; margin-bottom: 20px; }
        .logo span { color: var(--nefetc-blue); }
        input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid var(--border); border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: var(--nefetc-blue); color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; font-weight: bold; }

        /* Ana Uygulama TasarÄ±mÄ± */
        #app-content { display: none; }
        nav { background: white; border-bottom: 1px solid var(--border); padding: 10px 0; position: fixed; width: 100%; top: 0; z-index: 100; }
        .nav-container { max-width: 935px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; }
        
        .main-feed { max-width: 600px; margin: 80px auto; padding: 20px; }
        .post { background: white; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 25px; }
        .post-header { padding: 15px; font-weight: bold; border-bottom: 1px solid #efefef; }
        .post-img img { width: 100%; display: block; }
        .post-content { padding: 15px; }
        .post-link { color: var(--nefetc-blue); text-decoration: none; font-size: 14px; font-weight: bold; display: block; margin-top: 10px; }
        
        /* PaylaÅŸÄ±m ModalÄ± */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 200; }
        .modal-content { background: white; width: 400px; margin: 100px auto; padding: 20px; border-radius: 12px; }
    </style>
</head>
<body>

    <div id="auth-screen" class="auth-screen">
        <div class="auth-box">
            <h1 class="logo">Nefetc <span>Sosyal</span></h1>
            <input type="email" id="email" placeholder="E-posta adresi">
            <input type="password" id="password" placeholder="Åžifre">
            <button onclick="handleAuth('login')">GiriÅŸ Yap</button>
            <button style="background: #28a745;" onclick="handleAuth('signup')">KayÄ±t Ol</button>
        </div>
    </div>

    <div id="app-content">
        <nav>
            <div class="nav-container">
                <h2 class="logo" style="font-size: 20px; margin: 0;">Nefetc <span>Sosyal</span></h2>
                <div>
                    <button onclick="showModal()" style="width: auto; padding: 5px 15px;">+ PaylaÅŸ</button>
                    <button onclick="logout()" style="width: auto; padding: 5px 15px; background: #666;">Ã‡Ä±kÄ±ÅŸ</button>
                </div>
            </div>
        </nav>

        <div class="main-feed" id="feed">
            </div>
    </div>

    <div id="post-modal" class="modal">
        <div class="modal-content">
            <h3>Yeni GÃ¶nderi OluÅŸtur</h3>
            <input type="text" id="post-img-url" placeholder="Resim URL'si (Link)">
            <input type="text" id="post-caption" placeholder="Bir aÃ§Ä±klama yaz...">
            <input type="text" id="post-external-link" placeholder="Harici BaÄŸlantÄ± Linki (Opsiyonel)">
            <button onclick="sendPost()">PaylaÅŸ</button>
            <button onclick="closeModal()" style="background: #ccc;">Ä°ptal</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // FIREBASE AYARLARINI BURAYA YAPIÅžTIR
        // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCaTpXFw09UercktD5fJSjNs-WYtadQves",
  authDomain: "nefetc-sosyal.firebaseapp.com",
  projectId: "nefetc-sosyal",
  storageBucket: "nefetc-sosyal.firebasestorage.app",
  messagingSenderId: "951620230650",
  appId: "1:951620230650:web:74348f959975b04ce75843",
  measurementId: "G-TKBT5PD4V0"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

        // KullanÄ±cÄ± Durum Takibi
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('app-content').style.display = 'block';
                loadFeed();
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.getElementById('app-content').style.display = 'none';
            }
        });

        // GiriÅŸ/KayÄ±t Fonksiyonu
        window.handleAuth = async (type) => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            try {
                if(type === 'signup') await createUserWithEmailAndPassword(auth, email, pass);
                else await signInWithEmailAndPassword(auth, email, pass);
            } catch (e) { alert(e.message); }
        };

        // Ã‡Ä±kÄ±ÅŸ
        window.logout = () => signOut(auth);

        // PaylaÅŸÄ±m Yapma
        window.sendPost = async () => {
            const img = document.getElementById('post-img-url').value;
            const cap = document.getElementById('post-caption').value;
            const extLink = document.getElementById('post-external-link').value;
            
            if(!img || !cap) return alert("Resim ve aÃ§Ä±klama zorunludur!");

            await addDoc(collection(db, "posts"), {
                user: auth.currentUser.email,
                image: img,
                caption: cap,
                link: extLink,
                time: Date.now()
            });
            closeModal();
        };

        // AkÄ±ÅŸÄ± YÃ¼kle (Real-time)
        function loadFeed() {
            const q = query(collection(db, "posts"), orderBy("time", "desc"));
            onSnapshot(q, (snapshot) => {
                const feedDiv = document.getElementById('feed');
                feedDiv.innerHTML = "";
                snapshot.forEach(doc => {
                    const data = doc.data();
                    feedDiv.innerHTML += `
                        <div class="post">
                            <div class="post-header">${data.user}</div>
                            <div class="post-img"><img src="${data.image}"></div>
                            <div class="post-content">
                                <strong>${data.user}</strong> ${data.caption}
                                ${data.link ? `<a href="${data.link}" target="_blank" class="post-link">ðŸ”— BaÄŸlantÄ±ya Git</a>` : ''}
                            </div>
                        </div>
                    `;
                });
            });
        }

        // Modal Kontrolleri
        window.showModal = () => document.getElementById('post-modal').style.display = 'block';
        window.closeModal = () => document.getElementById('post-modal').style.display = 'none';
    </script>
</body>

</html>

